{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://schema.yext.com/config/analytics/conversion-action",
  "$version": "1.3",
  "$deprecationDate": "2020-07-31",
  "type": "object",
  "title": "Conversion Action",
  "description": "Configures a conversion action.",
  "properties": {
    "$id": {
      "type": "string",
      "description": "The unique identifier for the conversion action resource."
    },
    "$schema": {
      "const": "https://schema.yext.com/config/analytics/conversion-action/v1"
    },
    "conversionName": {
      "type": "string",
      "description": "The human-readable name of the conversion."
    },
    "conversionType": {
      "type": "string",
      "description": "The type of event that the conversion represents.",
      "enum": [
        "PURCHASE",
        "LEAD",
        "PAGE_VIEW",
        "SIGN_UP",
        "OTHER",
        "COST_SAVING_CUSTOMER_SUPPORT",
        "COST_SAVING_OTHER"
      ]
    },
    "conversionValueType": {
      "type": "string",
      "description": "The way a value is applied to the conversion, e.g. the same value for each conversion, or no value used.",
      "enum": [
        "SAME",
        "NONE"
      ]
    },
    "conversionValueAmount": {
      "type": "number",
      "description": "The value of the the conversion, set to the currency of the primary country associated with the Yext account. If conversionValueType is NONE, set to 0."
    },
    "conversionTrigger": {
      "oneOf": [
        {
          "type": "object",
          "description": "Click-based Conversion Triggers let you automatically treat certain clicks as conversions. For example, you can say that any Driving Direction click should be counted as a conversion. Click-based Conversion Triggers do not require the use of Javascript tags and work with all Yext products.",
          "properties": {
            "clickTriggers": {
              "type": "array",
              "description": "Defines which types of clicks are counted as a conversion.",
              "items": {
                "type": "object",
                "properties": {
                  "clickType": {
                    "type": "string",
                    "description": "The type of click that should be counted as a conversion.",
                    "enum": [
                      "CALL",
                      "DETAIL",
                      "DRIVING_DIRECTIONS",
                      "FEATURED_MESSAGE",
                      "UBER_LINK",
                      "WEB",
                      "OTHER_CLICK_TYPE",
                      "ALL_CLICK_TYPES",
                      "CALL_TO_ACTION",
                      "ORDER_NOW",
                      "TITLE",
                      "ADD_TO_CART",
                      "APPLY_NOW",
                      "THUMBS_UP",
                      "ROW_EXPAND",
                      "EMAIL",
                      "BOOK_APPOINTMENT",
                      "RSVP"
                    ]
                  },
                  "media": {
                    "type": "array",
                    "description": "The media source(s) of clicks to consider when counting conversions.",
                    "items": {
                      "oneOf": [
                        {
                          "type": "object",
                          "description": "The general Yext product type to source clicks from when counting conversions.",
                          "properties": {
                            "mediumType": {
                              "type": "string",
                              "enum": [
                                "ALL_LISTINGS_PUBLISHERS",
                                "ALL_ANSWERS_EXPERIENCES",
                                "ALL_SEARCH_ENGINES",
                                "ALL_PAGES_LOCATOR_OR_DIRECTORY",
                                "ALL_FIRST_PARTY_SITES",
                                "ALL_PAGES_LANDING_PAGE_SETS",
                                "ALL_REFERRAL_SITES",
                                "ALL_WIDGETS",
                                "ALL_MEDIUM_TYPES"
                              ]
                            }
                          },
                          "additionalProperties": false
                        },
                        {
                          "type": "object",
                          "description": "The specific Answers configuration to source clicks from when counting conversions.",
                          "properties": {
                            "answersConfig": {
                              "type": "string",
                              "format": "answers/answers-config"
                            }
                          },
                          "additionalProperties": false
                        }
                      ]
                    },
                    "minItems": 1,
                    "uniqueItems": true
                  },
                  "entityFilter": {
                    "type": "object",
                    "description": "The entities whose clicks should be counted as conversions.",
                    "minProperties": 1,
                    "additionalProperties": false,
                    "properties": {
                      "entityTypeIds": {
                        "type": "array",
                        "minItems": 1,
                        "description": "An array of entity-type resource identifiers to filter conversions by.",
                        "items": {
                          "type": "string",
                          "format": "km/entity-type"
                        }
                      },
                      "entityIds": {
                        "type": "array",
                        "minItems": 1,
                        "description": "An array of entity ids to filter conversions by.",
                        "items": {
                          "type": "string",
                          "format": "km/entity"
                        }
                      },
                      "labelIds": {
                        "type": "array",
                        "minItems": 1,
                        "description": "An array of entity label ids to filter conversions by.",
                        "items": {
                          "type": "string",
                          "format": "km/entity-label"
                        }
                      },
                      "folderIds": {
                        "type": "array",
                        "minItems": 1,
                        "description": "An array of entity folder ids to filter conversions by.",
                        "items": {
                          "type": "string",
                          "format": "km/entity-folder"
                        }
                      }
                    }
                  },
                  "startDate": {
                    "type": "string",
                    "description": "The start date, in \u0027YYYY-MM-DD\u0027 format, for the click trigger. Matching click events that occur on or after this date will be counted as conversions. Note that this date is interpreted in UTC time."
                  }
                },
                "additionalProperties": false,
                "required": [
                  "clickType",
                  "media",
                  "startDate"
                ]
              },
              "minItems": 1,
              "uniqueItems": true
            },
            "completionRate": {
              "type": "number",
              "description": "Specifies the percentage of events that should count as conversions.",
              "minimum": 1,
              "maximum": 100
            }
          },
          "additionalProperties": false,
          "required": [
            "clickTriggers",
            "completionRate"
          ]
        }
      ]
    },
    "enabled": {
      "type": "boolean",
      "description": "Whether or not the conversion resource should be considered active. Conversions will not be counted for disabled conversion resources."
    }
  },
  "additionalProperties": false,
  "required": [
    "$id",
    "$schema",
    "conversionName",
    "conversionType",
    "conversionValueType",
    "conversionValueAmount",
    "conversionTrigger",
    "enabled"
  ]
}